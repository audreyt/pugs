v6.pm hacking how-to

* links

The development repository is:
http://svn.openfoundry.org/pugs/perl5/

The CPAN distribution is:
http://search.cpan.org/dist/v6-alpha/

The irc channel for development is:
#perl6 on freenode

* #perl6 jargon

PCR - the Pugs::Compiler::Rule module - implements Perl 6 parser tools: rule, token, regex, P5 regex, and precedence parser.
PCP6 or v6.pm or v6 - Pugs::Compiler::Perl6
lrep - an older version of v6.pm

* Environment variables

  V6DUMPAST=1  - tells the code emitter to dump the syntax tree to STDOUT before processing

  PERL6LIB=dir;dir  - same usage as PERL5LIB

* Compilation cycle:

  Source file ->
  Parser -> 
  Emitter ->
  Execute

* Implementing new syntax

-- set the V6DUMPAST environment variable 
-- try a simple test with the new syntax:
  perl -Ilib lib/v6.pm --compile-only ' say 42 '
-- if the syntax tree looks ok, the new syntax can be implemented in the emitter file - see the Emitter section below.
-- in order to implement of fix syntax tree nodes, see the Parsing section for choosing which file to edit.

* Source file processors:

lib/v6.pm 
-- provides compatibility with other perl 6 implementations, by implementing "use v6-alpha;"

-- provides pre-compilation through Module::Compile

lib/Pugs/Compiler/Perl6
-- subclasses Pugs::Compiler::Rule to implement the "perl 6 compiler"

* Parsing

The syntax is mostly implemented using perl 6 rules, which are provided by the Pugs::Compiler::Rule module.

A few "terms" are implemented using perl 5 modules, such as Pugs::Grammar::Precedence (called from Expression.pm), and Text::Balanced (called from Term.pm)

lib/Pugs/Grammar/*
-- Perl6.pm
  - statements
-- Term.pm
  - number, string, :a<b>
-- Expression.pm 
  - detects end-of-expresion
  - parses some terms, like method calls
-- Operator, BaseCategory.pm
  - Infrastructure for operator tables
-- Infix, Prefix, Postfix, Postcircumfix, Circumfix, Ternary
  - operator tables; most of the work is done by Pugs::Grammar::Precedence
-- P6Rule.pm
  - parser for rules (almost a duplicate of the one in Pugs::Runtime::Rule)

-- StatementControl.pm and Pod.pm are currently not used

* Code Emitter

lib/Pugs/Emitter/Perl6/Perl5.pm
-- gets a syntax tree and generates Perl5 code

* Execute (Runtime)

lib/Pugs/Runtime/Perl6.pm
-- provides routines and objects that help emulate perl 6 semantics.


=head1 COPYRIGHT

Copyright 2006 by Flavio Soibelmann Glock and others.

This program is free software; you can redistribute it and/or modify it
under the same terms as Perl itself.

See L<http://www.perl.com/perl/misc/Artistic.html>

=cut
