#!/usr/local/bin/perl

use STD;
use DumpMatch;
use utf8;
use YAML::XS;
use Encode;
use strict;
use warnings;
use Getopt::Long;
my $nocolor = 0;
my $vertical = 0;
my $yaml = 0;
GetOptions("nocolor"=>\$nocolor,"vertical"=>\$vertical,"yaml"=>\$yaml);
unless ($#ARGV <= 0) {
    die "USAGE: [--nocolor --vertical] [filename]\n";
}
if ($nocolor) {
    $DumpMatch::NOCOLOR = 1;
}

my $what = 'comp_unit';
my $text;
{
local $/;
$text = Encode::decode('utf8', scalar <>);
}

my $r = Perl->new($text)->$what();
if ($yaml) {
    print Dump($r);
    exit;
} else {
    print dump_match($what=>$r,{vertical=>$vertical}),"\n";
}

