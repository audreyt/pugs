#!/usr/bin/perl

use strict;
use warnings;

my $platform = shift;

use Cwd;
my $dir = getcwd;

my $SPEC = $dir =~ /\bspec\b/;
while (not -f "$dir/util/fudge") {
    die "Not inside pugs directory\n" unless $dir;
    $dir =~ s!(.*)/(.*)!!;
}

print join(' ',
    map {
	if ($SPEC or m!\bspec\b!) {
	    chomp(my $pick = `$dir/util/fudge $platform $_`);
	    $pick;
	}
	else {
	    $_;
	}
    } @ARGV
), "\n";
