use v6-alpha;


=pod

Pugs' translation of UTF-8 into unicode strings works in 4k chunks,
as benchmarks have shown this to be fastest.

Unfortunately, unless a chunk ends in on a character boundary, the last
code point to be decoded in a chunk will fail, until the decoder is
fixed to carry untreated bytes over to the next chunk.

This test does not fail in the proper sense; but it does at least emit
warnings until the error is corrected. Fixes to this are welcome.

The plan: pass a test, but have characters fall off 4k chunks. To battle
Murphy viz. different lineendings, a character represented by three
bytes is used, and two chunks ends hit it.

=cut

use Test;

plan 1;

pass "parsed";

# And here comes the happy character:

# ￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮￮
