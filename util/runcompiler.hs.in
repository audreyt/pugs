module Main where
import IO
import System.Cmd
import System.Exit
import System.Directory
import System.Environment

main = do
	let config_path = "__CONFIG_PATH__"
	createInstallPath config_path
	args <- getArgs
	let ghc = "__GHC__ -package-conf " ++ config_path
	exitcode <- system (foldl (\x y -> x ++ " " ++ y) ghc args)
	exitWith exitcode

createInstallPath path = do
	config_exists <- doesFileExist path
	if config_exists
		then return ()
		else bracket (openFile path WriteMode) hClose (\h -> do hPutStr h "[]")
