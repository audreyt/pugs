<html>
<head>
    <script type="text/javascript" src="../lib/Perl6/MetaModel.js"></script>
    <script type="text/javascript">
        require.INC = "../inc";    
        require('Test.Builder');
        require('Test.More'); 
        
        require.INC = "../lib";    
        require('Perl6.MetaClass');   
        require('Perl6.Class');                
    </script>         
</head>
<body>
<pre id='test'><script type="text/javascript">

plan({ tests : 20 });

var Foo = new Perl6.Class ('Foo', {
    'class' : {
        'methods' : {
            'bar' : function () { return 'Foo.bar'; },
            'blah' : function (klass, name) { return klass + ".baz(" + name + ")"; }
        }
    }
});
isaOK(Foo, 'Perl6.Class');

isaOK(Foo.meta(), 'Perl6.MetaClass');

ok(Foo.isa('Foo'), '... our class isa Foo');
ok(!Foo.isa('Bar'), '... our class is not a Bar');

ok(Foo.can('bar'), '... Foo can bar()');
ok(!Foo.can('baz'), '... Foo cant baz()');

isaOK(Foo.can('bar'), 'Perl6.Method');
is(Foo.can('bar').call(), 'Foo.bar', '... Foo.bar() returns "Foo.bar"');

is(Foo.can('blah').call(Foo, "Stevan"), 'Perl6.Class=[Foo-0.0.0].baz(Stevan)', '... Foo.baz() takes arguments');

// ...

var Bar = new Perl6.Class ('Bar', { 
    'is' : [ Foo ],
    'class' : {
        'methods' : {
            'foo' : function () { return 'Bar.foo' }
        }
    }    
});
isaOK(Bar, 'Perl6.Class');

ok(Bar.isa('Bar'), '... our class isa Bar');
ok(Bar.isa('Foo'), '... our class isa Foo');
ok(!Bar.isa('Baz'), '... our class is not a Baz');

ok(Bar.can('foo'), '... Bar can bar()');
ok(Bar.can('bar'), '... Bar can bar()');
ok(!Bar.can('baz'), '... Bar cant baz()');

isaOK(Bar.can('bar'), 'Perl6.Method');
is(Bar.can('bar').call(), 'Foo.bar', '... Bar.bar() returns "Foo.bar"');

isaOK(Bar.can('foo'), 'Perl6.Method');
is(Bar.can('foo').call(), 'Bar.foo', '... Bar.foo() returns "Bar.foo"');


</script></pre>
</body>
</html>