{-# OPTIONS_GHC -fglasgow-exts -fno-full-laziness -fno-cse -cpp -fallow-overlapping-instances #-}

module Pugs.Parser.Charnames (nameToCode) where

import Pugs.Internals

#ifdef PUGS_HAVE_PERL5

import Pugs.Embed.Perl5

-- If we do have Perl 5, support for all unicode names via Perl5's charnames::vianame.

nameToCode :: String -> Maybe Int
nameToCode name = inlinePerformIO $ do
    sv      <- evalPerl5 ("use utf8; use charnames ':full'; ord(qq[\\N{"++name++"}])") nullEnv 1
    svToVInt sv >>= \iv -> case iv of
        0 -> svToVStr sv >>= \pv -> case pv of
            "0" -> return (Just 0)
            _   -> return Nothing   -- undef
        x -> return (Just x)

#else

import qualified Data.HashTable as H
import Data.ByteString.Unsafe (unsafePackAddressLen)

-- If we don't have Perl 5, support for names in the 0x00 - 0xFF range only.

nameToCode :: String -> Maybe Int
nameToCode name = inlinePerformIO (H.lookup _NameToCode (cast name))

{-# NOINLINE _NameToCode #-}
_NameToCode :: H.HashTable ByteString Int
_NameToCode = unsafePerformIO $! hashList =<< mapM compute
    [ (unsafePackAddressLen 4 "NULL"#, 0x0000)
    , (unsafePackAddressLen 16 "START OF HEADING"#, 0x0001)
    , (unsafePackAddressLen 13 "START OF TEXT"#, 0x0002)
    , (unsafePackAddressLen 11 "END OF TEXT"#, 0x0003)
    , (unsafePackAddressLen 19 "END OF TRANSMISSION"#, 0x0004)
    , (unsafePackAddressLen 7 "ENQUIRY"#, 0x0005)
    , (unsafePackAddressLen 11 "ACKNOWLEDGE"#, 0x0006)
    , (unsafePackAddressLen 4 "BELL"#, 0x0007)
    , (unsafePackAddressLen 9 "BACKSPACE"#, 0x0008)
    , (unsafePackAddressLen 20 "CHARACTER TABULATION"#, 0x0009)
    , (unsafePackAddressLen 14 "LINE FEED (LF)"#, 0x000A)
    , (unsafePackAddressLen 9 "LINE FEED"#, 0x000A)
    , (unsafePackAddressLen 15 "LINE TABULATION"#, 0x000B)
    , (unsafePackAddressLen 14 "FORM FEED (FF)"#, 0x000C)
    , (unsafePackAddressLen 9 "FORM FEED"#, 0x000C)
    , (unsafePackAddressLen 20 "CARRIAGE RETURN (CR)"#, 0x000D)
    , (unsafePackAddressLen 15 "CARRIAGE RETURN"#, 0x000D)
    , (unsafePackAddressLen 9 "SHIFT OUT"#, 0x000E)
    , (unsafePackAddressLen 8 "SHIFT IN"#, 0x000F)
    , (unsafePackAddressLen 16 "DATA LINK ESCAPE"#, 0x0010)
    , (unsafePackAddressLen 18 "DEVICE CONTROL ONE"#, 0x0011)
    , (unsafePackAddressLen 18 "DEVICE CONTROL TWO"#, 0x0012)
    , (unsafePackAddressLen 20 "DEVICE CONTROL THREE"#, 0x0013)
    , (unsafePackAddressLen 19 "DEVICE CONTROL FOUR"#, 0x0014)
    , (unsafePackAddressLen 20 "NEGATIVE ACKNOWLEDGE"#, 0x0015)
    , (unsafePackAddressLen 16 "SYNCHRONOUS IDLE"#, 0x0016)
    , (unsafePackAddressLen 25 "END OF TRANSMISSION BLOCK"#, 0x0017)
    , (unsafePackAddressLen 6 "CANCEL"#, 0x0018)
    , (unsafePackAddressLen 13 "END OF MEDIUM"#, 0x0019)
    , (unsafePackAddressLen 10 "SUBSTITUTE"#, 0x001A)
    , (unsafePackAddressLen 6 "ESCAPE"#, 0x001B)
    , (unsafePackAddressLen 26 "INFORMATION SEPARATOR FOUR"#, 0x001C)
    , (unsafePackAddressLen 27 "INFORMATION SEPARATOR THREE"#, 0x001D)
    , (unsafePackAddressLen 25 "INFORMATION SEPARATOR TWO"#, 0x001E)
    , (unsafePackAddressLen 25 "INFORMATION SEPARATOR ONE"#, 0x001F)
    , (unsafePackAddressLen 5 "SPACE"#, 0x0020)
    , (unsafePackAddressLen 16 "EXCLAMATION MARK"#, 0x0021)
    , (unsafePackAddressLen 14 "QUOTATION MARK"#, 0x0022)
    , (unsafePackAddressLen 11 "NUMBER SIGN"#, 0x0023)
    , (unsafePackAddressLen 11 "DOLLAR SIGN"#, 0x0024)
    , (unsafePackAddressLen 12 "PERCENT SIGN"#, 0x0025)
    , (unsafePackAddressLen 9 "AMPERSAND"#, 0x0026)
    , (unsafePackAddressLen 10 "APOSTROPHE"#, 0x0027)
    , (unsafePackAddressLen 16 "LEFT PARENTHESIS"#, 0x0028)
    , (unsafePackAddressLen 17 "RIGHT PARENTHESIS"#, 0x0029)
    , (unsafePackAddressLen 8 "ASTERISK"#, 0x002A)
    , (unsafePackAddressLen 9 "PLUS SIGN"#, 0x002B)
    , (unsafePackAddressLen 5 "COMMA"#, 0x002C)
    , (unsafePackAddressLen 12 "HYPHEN-MINUS"#, 0x002D)
    , (unsafePackAddressLen 9 "FULL STOP"#, 0x002E)
    , (unsafePackAddressLen 7 "SOLIDUS"#, 0x002F)
    , (unsafePackAddressLen 10 "DIGIT ZERO"#, 0x0030)
    , (unsafePackAddressLen 9 "DIGIT ONE"#, 0x0031)
    , (unsafePackAddressLen 9 "DIGIT TWO"#, 0x0032)
    , (unsafePackAddressLen 11 "DIGIT THREE"#, 0x0033)
    , (unsafePackAddressLen 10 "DIGIT FOUR"#, 0x0034)
    , (unsafePackAddressLen 10 "DIGIT FIVE"#, 0x0035)
    , (unsafePackAddressLen 9 "DIGIT SIX"#, 0x0036)
    , (unsafePackAddressLen 11 "DIGIT SEVEN"#, 0x0037)
    , (unsafePackAddressLen 11 "DIGIT EIGHT"#, 0x0038)
    , (unsafePackAddressLen 10 "DIGIT NINE"#, 0x0039)
    , (unsafePackAddressLen 5 "COLON"#, 0x003A)
    , (unsafePackAddressLen 9 "SEMICOLON"#, 0x003B)
    , (unsafePackAddressLen 14 "LESS-THAN SIGN"#, 0x003C)
    , (unsafePackAddressLen 11 "EQUALS SIGN"#, 0x003D)
    , (unsafePackAddressLen 17 "GREATER-THAN SIGN"#, 0x003E)
    , (unsafePackAddressLen 13 "QUESTION MARK"#, 0x003F)
    , (unsafePackAddressLen 13 "COMMERCIAL AT"#, 0x0040)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER A"#, 0x0041)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER B"#, 0x0042)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER C"#, 0x0043)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER D"#, 0x0044)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER E"#, 0x0045)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER F"#, 0x0046)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER G"#, 0x0047)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER H"#, 0x0048)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER I"#, 0x0049)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER J"#, 0x004A)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER K"#, 0x004B)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER L"#, 0x004C)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER M"#, 0x004D)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER N"#, 0x004E)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER O"#, 0x004F)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER P"#, 0x0050)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER Q"#, 0x0051)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER R"#, 0x0052)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER S"#, 0x0053)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER T"#, 0x0054)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER U"#, 0x0055)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER V"#, 0x0056)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER W"#, 0x0057)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER X"#, 0x0058)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER Y"#, 0x0059)
    , (unsafePackAddressLen 22 "LATIN CAPITAL LETTER Z"#, 0x005A)
    , (unsafePackAddressLen 19 "LEFT SQUARE BRACKET"#, 0x005B)
    , (unsafePackAddressLen 15 "REVERSE SOLIDUS"#, 0x005C)
    , (unsafePackAddressLen 20 "RIGHT SQUARE BRACKET"#, 0x005D)
    , (unsafePackAddressLen 17 "CIRCUMFLEX ACCENT"#, 0x005E)
    , (unsafePackAddressLen 8 "LOW LINE"#, 0x005F)
    , (unsafePackAddressLen 12 "GRAVE ACCENT"#, 0x0060)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER A"#, 0x0061)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER B"#, 0x0062)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER C"#, 0x0063)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER D"#, 0x0064)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER E"#, 0x0065)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER F"#, 0x0066)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER G"#, 0x0067)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER H"#, 0x0068)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER I"#, 0x0069)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER J"#, 0x006A)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER K"#, 0x006B)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER L"#, 0x006C)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER M"#, 0x006D)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER N"#, 0x006E)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER O"#, 0x006F)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER P"#, 0x0070)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER Q"#, 0x0071)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER R"#, 0x0072)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER S"#, 0x0073)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER T"#, 0x0074)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER U"#, 0x0075)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER V"#, 0x0076)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER W"#, 0x0077)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER X"#, 0x0078)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER Y"#, 0x0079)
    , (unsafePackAddressLen 20 "LATIN SMALL LETTER Z"#, 0x007A)
    , (unsafePackAddressLen 18 "LEFT CURLY BRACKET"#, 0x007B)
    , (unsafePackAddressLen 13 "VERTICAL LINE"#, 0x007C)
    , (unsafePackAddressLen 19 "RIGHT CURLY BRACKET"#, 0x007D)
    , (unsafePackAddressLen 5 "TILDE"#, 0x007E)
    , (unsafePackAddressLen 6 "DELETE"#, 0x007F)
    , (unsafePackAddressLen 20 "BREAK PERMITTED HERE"#, 0x0082)
    , (unsafePackAddressLen 13 "NO BREAK HERE"#, 0x0083)
    , (unsafePackAddressLen 15 "NEXT LINE (NEL)"#, 0x0085)
    , (unsafePackAddressLen 9 "NEXT LINE"#, 0x0085)
    , (unsafePackAddressLen 22 "START OF SELECTED AREA"#, 0x0086)
    , (unsafePackAddressLen 20 "END OF SELECTED AREA"#, 0x0087)
    , (unsafePackAddressLen 24 "CHARACTER TABULATION SET"#, 0x0088)
    , (unsafePackAddressLen 39 "CHARACTER TABULATION WITH JUSTIFICATION"#, 0x0089)
    , (unsafePackAddressLen 19 "LINE TABULATION SET"#, 0x008A)
    , (unsafePackAddressLen 20 "PARTIAL LINE FORWARD"#, 0x008B)
    , (unsafePackAddressLen 21 "PARTIAL LINE BACKWARD"#, 0x008C)
    , (unsafePackAddressLen 17 "REVERSE LINE FEED"#, 0x008D)
    , (unsafePackAddressLen 16 "SINGLE SHIFT TWO"#, 0x008E)
    , (unsafePackAddressLen 18 "SINGLE SHIFT THREE"#, 0x008F)
    , (unsafePackAddressLen 21 "DEVICE CONTROL STRING"#, 0x0090)
    , (unsafePackAddressLen 15 "PRIVATE USE ONE"#, 0x0091)
    , (unsafePackAddressLen 15 "PRIVATE USE TWO"#, 0x0092)
    , (unsafePackAddressLen 18 "SET TRANSMIT STATE"#, 0x0093)
    , (unsafePackAddressLen 16 "CANCEL CHARACTER"#, 0x0094)
    , (unsafePackAddressLen 15 "MESSAGE WAITING"#, 0x0095)
    , (unsafePackAddressLen 21 "START OF GUARDED AREA"#, 0x0096)
    , (unsafePackAddressLen 19 "END OF GUARDED AREA"#, 0x0097)
    , (unsafePackAddressLen 15 "START OF STRING"#, 0x0098)
    , (unsafePackAddressLen 27 "SINGLE CHARACTER INTRODUCER"#, 0x009A)
    , (unsafePackAddressLen 27 "CONTROL SEQUENCE INTRODUCER"#, 0x009B)
    , (unsafePackAddressLen 17 "STRING TERMINATOR"#, 0x009C)
    , (unsafePackAddressLen 24 "OPERATING SYSTEM COMMAND"#, 0x009D)
    , (unsafePackAddressLen 15 "PRIVACY MESSAGE"#, 0x009E)
    , (unsafePackAddressLen 27 "APPLICATION PROGRAM COMMAND"#, 0x009F)
    , (unsafePackAddressLen 14 "NO-BREAK SPACE"#, 0x00A0)
    , (unsafePackAddressLen 25 "INVERTED EXCLAMATION MARK"#, 0x00A1)
    , (unsafePackAddressLen 9 "CENT SIGN"#, 0x00A2)
    , (unsafePackAddressLen 10 "POUND SIGN"#, 0x00A3)
    , (unsafePackAddressLen 13 "CURRENCY SIGN"#, 0x00A4)
    , (unsafePackAddressLen 8 "YEN SIGN"#, 0x00A5)
    , (unsafePackAddressLen 10 "BROKEN BAR"#, 0x00A6)
    , (unsafePackAddressLen 12 "SECTION SIGN"#, 0x00A7)
    , (unsafePackAddressLen 9 "DIAERESIS"#, 0x00A8)
    , (unsafePackAddressLen 14 "COPYRIGHT SIGN"#, 0x00A9)
    , (unsafePackAddressLen 26 "FEMININE ORDINAL INDICATOR"#, 0x00AA)
    , (unsafePackAddressLen 41 "LEFT-POINTING DOUBLE ANGLE QUOTATION MARK"#, 0x00AB)
    , (unsafePackAddressLen 8 "NOT SIGN"#, 0x00AC)
    , (unsafePackAddressLen 11 "SOFT HYPHEN"#, 0x00AD)
    , (unsafePackAddressLen 15 "REGISTERED SIGN"#, 0x00AE)
    , (unsafePackAddressLen 6 "MACRON"#, 0x00AF)
    , (unsafePackAddressLen 11 "DEGREE SIGN"#, 0x00B0)
    , (unsafePackAddressLen 15 "PLUS-MINUS SIGN"#, 0x00B1)
    , (unsafePackAddressLen 15 "SUPERSCRIPT TWO"#, 0x00B2)
    , (unsafePackAddressLen 17 "SUPERSCRIPT THREE"#, 0x00B3)
    , (unsafePackAddressLen 12 "ACUTE ACCENT"#, 0x00B4)
    , (unsafePackAddressLen 10 "MICRO SIGN"#, 0x00B5)
    , (unsafePackAddressLen 12 "PILCROW SIGN"#, 0x00B6)
    , (unsafePackAddressLen 10 "MIDDLE DOT"#, 0x00B7)
    , (unsafePackAddressLen 7 "CEDILLA"#, 0x00B8)
    , (unsafePackAddressLen 15 "SUPERSCRIPT ONE"#, 0x00B9)
    , (unsafePackAddressLen 27 "MASCULINE ORDINAL INDICATOR"#, 0x00BA)
    , (unsafePackAddressLen 42 "RIGHT-POINTING DOUBLE ANGLE QUOTATION MARK"#, 0x00BB)
    , (unsafePackAddressLen 27 "VULGAR FRACTION ONE QUARTER"#, 0x00BC)
    , (unsafePackAddressLen 24 "VULGAR FRACTION ONE HALF"#, 0x00BD)
    , (unsafePackAddressLen 30 "VULGAR FRACTION THREE QUARTERS"#, 0x00BE)
    , (unsafePackAddressLen 22 "INVERTED QUESTION MARK"#, 0x00BF)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER A WITH GRAVE"#, 0x00C0)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER A WITH ACUTE"#, 0x00C1)
    , (unsafePackAddressLen 38 "LATIN CAPITAL LETTER A WITH CIRCUMFLEX"#, 0x00C2)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER A WITH TILDE"#, 0x00C3)
    , (unsafePackAddressLen 37 "LATIN CAPITAL LETTER A WITH DIAERESIS"#, 0x00C4)
    , (unsafePackAddressLen 38 "LATIN CAPITAL LETTER A WITH RING ABOVE"#, 0x00C5)
    , (unsafePackAddressLen 23 "LATIN CAPITAL LETTER AE"#, 0x00C6)
    , (unsafePackAddressLen 35 "LATIN CAPITAL LETTER C WITH CEDILLA"#, 0x00C7)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER E WITH GRAVE"#, 0x00C8)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER E WITH ACUTE"#, 0x00C9)
    , (unsafePackAddressLen 38 "LATIN CAPITAL LETTER E WITH CIRCUMFLEX"#, 0x00CA)
    , (unsafePackAddressLen 37 "LATIN CAPITAL LETTER E WITH DIAERESIS"#, 0x00CB)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER I WITH GRAVE"#, 0x00CC)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER I WITH ACUTE"#, 0x00CD)
    , (unsafePackAddressLen 38 "LATIN CAPITAL LETTER I WITH CIRCUMFLEX"#, 0x00CE)
    , (unsafePackAddressLen 37 "LATIN CAPITAL LETTER I WITH DIAERESIS"#, 0x00CF)
    , (unsafePackAddressLen 24 "LATIN CAPITAL LETTER ETH"#, 0x00D0)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER N WITH TILDE"#, 0x00D1)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER O WITH GRAVE"#, 0x00D2)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER O WITH ACUTE"#, 0x00D3)
    , (unsafePackAddressLen 38 "LATIN CAPITAL LETTER O WITH CIRCUMFLEX"#, 0x00D4)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER O WITH TILDE"#, 0x00D5)
    , (unsafePackAddressLen 37 "LATIN CAPITAL LETTER O WITH DIAERESIS"#, 0x00D6)
    , (unsafePackAddressLen 19 "MULTIPLICATION SIGN"#, 0x00D7)
    , (unsafePackAddressLen 34 "LATIN CAPITAL LETTER O WITH STROKE"#, 0x00D8)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER U WITH GRAVE"#, 0x00D9)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER U WITH ACUTE"#, 0x00DA)
    , (unsafePackAddressLen 38 "LATIN CAPITAL LETTER U WITH CIRCUMFLEX"#, 0x00DB)
    , (unsafePackAddressLen 37 "LATIN CAPITAL LETTER U WITH DIAERESIS"#, 0x00DC)
    , (unsafePackAddressLen 33 "LATIN CAPITAL LETTER Y WITH ACUTE"#, 0x00DD)
    , (unsafePackAddressLen 26 "LATIN CAPITAL LETTER THORN"#, 0x00DE)
    , (unsafePackAddressLen 26 "LATIN SMALL LETTER SHARP S"#, 0x00DF)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER A WITH GRAVE"#, 0x00E0)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER A WITH ACUTE"#, 0x00E1)
    , (unsafePackAddressLen 36 "LATIN SMALL LETTER A WITH CIRCUMFLEX"#, 0x00E2)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER A WITH TILDE"#, 0x00E3)
    , (unsafePackAddressLen 35 "LATIN SMALL LETTER A WITH DIAERESIS"#, 0x00E4)
    , (unsafePackAddressLen 36 "LATIN SMALL LETTER A WITH RING ABOVE"#, 0x00E5)
    , (unsafePackAddressLen 21 "LATIN SMALL LETTER AE"#, 0x00E6)
    , (unsafePackAddressLen 33 "LATIN SMALL LETTER C WITH CEDILLA"#, 0x00E7)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER E WITH GRAVE"#, 0x00E8)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER E WITH ACUTE"#, 0x00E9)
    , (unsafePackAddressLen 36 "LATIN SMALL LETTER E WITH CIRCUMFLEX"#, 0x00EA)
    , (unsafePackAddressLen 35 "LATIN SMALL LETTER E WITH DIAERESIS"#, 0x00EB)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER I WITH GRAVE"#, 0x00EC)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER I WITH ACUTE"#, 0x00ED)
    , (unsafePackAddressLen 36 "LATIN SMALL LETTER I WITH CIRCUMFLEX"#, 0x00EE)
    , (unsafePackAddressLen 35 "LATIN SMALL LETTER I WITH DIAERESIS"#, 0x00EF)
    , (unsafePackAddressLen 22 "LATIN SMALL LETTER ETH"#, 0x00F0)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER N WITH TILDE"#, 0x00F1)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER O WITH GRAVE"#, 0x00F2)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER O WITH ACUTE"#, 0x00F3)
    , (unsafePackAddressLen 36 "LATIN SMALL LETTER O WITH CIRCUMFLEX"#, 0x00F4)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER O WITH TILDE"#, 0x00F5)
    , (unsafePackAddressLen 35 "LATIN SMALL LETTER O WITH DIAERESIS"#, 0x00F6)
    , (unsafePackAddressLen 13 "DIVISION SIGN"#, 0x00F7)
    , (unsafePackAddressLen 32 "LATIN SMALL LETTER O WITH STROKE"#, 0x00F8)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER U WITH GRAVE"#, 0x00F9)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER U WITH ACUTE"#, 0x00FA)
    , (unsafePackAddressLen 36 "LATIN SMALL LETTER U WITH CIRCUMFLEX"#, 0x00FB)
    , (unsafePackAddressLen 35 "LATIN SMALL LETTER U WITH DIAERESIS"#, 0x00FC)
    , (unsafePackAddressLen 31 "LATIN SMALL LETTER Y WITH ACUTE"#, 0x00FD)
    , (unsafePackAddressLen 24 "LATIN SMALL LETTER THORN"#, 0x00FE)
    , (unsafePackAddressLen 35 "LATIN SMALL LETTER Y WITH DIAERESIS"#, 0x00FF)
    ]
    where
    hashList :: [(ByteString, a)] -> IO (H.HashTable ByteString a)
    hashList = H.fromList hashByteString
    compute (f, y) = f >>= \x -> return (x, y)

#endif
